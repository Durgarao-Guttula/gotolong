

1> NSE 
Download following

https://www.nseindia.com/content/indices/ind_nifty500list.csv

https://www.nseindia.com/products/content/equities/indices/nifty_500.htm


2> BSE

Download following

https://www.bseindia.com/sensexview/IndicesWatch_weight.aspx?iname=BSE500&index_Code=17


click on excel icon on right hand side.
